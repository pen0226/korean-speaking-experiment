# =====================================================
# AI 기반 한국어 말하기 피드백 시스템 - 범용 호환 버전
# Korean Speaking AI Feedback System - Universal Compatible
# =====================================================

# === 핵심 웹 프레임워크 (필수) ===
streamlit==1.39.0
streamlit-mic-recorder==0.0.8

# === AI API 서비스 (범용 호환) ===
openai>=1.3.0,<2.0.0  # 🔥 하이브리드 호환: v1.x 모든 버전 지원
elevenlabs==1.8.0

# === 연구용 데이터 분석 및 Excel 생성 ===
pandas>=1.5.0,<3.0.0  # 🆕 연구용 Excel 데이터프레임 생성
openpyxl>=3.1.0,<4.0.0  # 🆕 Excel 파일 작성 엔진

# === PDF 생성 (동의서) ===
reportlab==4.2.5

# === Google Cloud Storage 백업 시스템 ===
google-auth==2.35.0
google-cloud-storage==2.18.2

# === 환경변수 (로컬 개발용) ===
python-dotenv==1.0.1

# =====================================================
# 🔥 하이브리드 호환성 보장:
#
# ✅ OpenAI SDK 범용 지원:
# - 로컬: 최신 버전 (1.51.2) 사용 가능
# - Streamlit Cloud: 안정 버전 (1.35.0) 자동 적용
# - 코드에서 자동 버전 감지 및 적절한 API 호출
#
# ✅ 연구용 분석 기능 추가:
# - TOPIK 기준 3영역 자동 점수 계산
# - 채점자용 Excel 파일 자동 생성
# - 5개 시트: 요약/상세분석/점수비교/원본데이터
# - CSV 호환성 유지 (Excel 대안)
#
# ✅ 환경별 자동 최적화:
# - SDK 버전 자동 감지
# - Modern API vs Legacy API 자동 선택
# - Streamlit Cloud proxies 문제 자동 해결
# - pandas/openpyxl 범용 호환 버전 사용
#
# ✅ 모든 핵심 기능 유지:
# - 음성 인식: OpenAI Whisper API (완벽 호환)
# - AI 피드백: GPT-4o (동일)
# - 음성 합성: ElevenLabs (최신)
# - 자동 백업: GCS (동일)
# - 🆕 연구 분석: TOPIK 기준 자동 채점
#
# 🔧 동작 방식:
# - 로컬: Modern SDK (client.audio.transcriptions.create)
# - 클라우드: 환경에 따라 자동 선택
# - 에러 발생시 자동 fallback
# - Excel 생성 실패시 CSV로 fallback
#
# Streamlit Cloud Secrets 설정 (동일):
# - OPENAI_API_KEY
# - ELEVENLABS_API_KEY  
# - ELEVEN_VOICE_ID
# - gcp_service_account (JSON)
# - GCS_BUCKET_NAME
# - GCS_ENABLED=true
# =====================================================